function doPost(e) { try { const SPREADSHEET_ID = "1tRJZM-jH6yD-chWi-hzroXadFvCmz9fX-p0gLHghWOg"; const spreadsheet = SpreadsheetApp.openById(SPREADSHEET_ID); const sheet = spreadsheet.getActiveSheet(); const data = JSON.parse(e.postData.contents); const email = data.email; const timestamp = new Date().toISOString(); const source = data.source || "CelesteOS Landing Page"; const userAgent = data.userAgent || "Unknown"; const location = data.location || "Unknown"; sheet.appendRow([email, timestamp, location, userAgent]); return ContentService.createTextOutput(JSON.stringify({success: true, message: "Email saved successfully"})).setMimeType(ContentService.MimeType.JSON); } catch (error) { return ContentService.createTextOutput(JSON.stringify({success: false, error: error.toString()})).setMimeType(ContentService.MimeType.JSON); } } function doGet(e) { return ContentService.createTextOutput(JSON.stringify({message: "Email capture endpoint is working"})).setMimeType(ContentService.MimeType.JSON); }
